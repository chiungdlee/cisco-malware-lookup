from typing import List
from support.models import db, MalwareURL

class URLDatabase:
    def __init__(self, db):
        self.db = db

    def is_safe(self, url: str) -> bool:
        """
        Check if a URL is safe.
        :param url: The URL to check.
        :return: True if the URL is safe, False if it is known to contain malware.
        """
        return db.session.query(MalwareURL).filter_by(url=url).count() == 0

    def update_urls(self, new_urls: List[str]) -> None:
        """
        Update the database with new malware URLs.
        :param new_urls: A list of new malware URLs to add.
        :return: None
        """
        for url in new_urls:
            if not db.session.query(MalwareURL).filter_by(url=url).count():
                db.session.add(MalwareURL(url))
        db.session.commit()
